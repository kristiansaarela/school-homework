Funktsioonid ja avaldised.

Lisa iga ülesande juurde käsk ja tuelemus.


1. Leia kui palju erinevad laste pikkused keskmisest pikkusest. (Väljasta lapse nimi, pikkus, keskmine pikkus ja erinevus keskmisest pikkusest)

mysql> select L_nimi, Synnipikkus, (select avg(Synnipikkus) from SYNNID) as keskmine_pikkus, (select sub.Synnipikkus - keskmine_pikkus from SYNNID as sub where sub.L_nimi = s.L_nimi and sub.Synnipikkus = s.Synnipikkus) as erinevus from SYNNID as s order by erinevus;
+-----------+-------------+-----------------+----------+
| L_nimi    | Synnipikkus | keskmine_pikkus | erinevus |
+-----------+-------------+-----------------+----------+
| Richard   |          46 |         51.1923 |  -5.1923 | 
| Kaur      |          46 |         51.1923 |  -5.1923 | 
| Elis      |          47 |         51.1923 |  -4.1923 | 
| Ramona    |          47 |         51.1923 |  -4.1923 | 
| Rasmus    |          47 |         51.1923 |  -4.1923 | 
| Liisi     |          48 |         51.1923 |  -3.1923 | 
| Tanel     |          48 |         51.1923 |  -3.1923 | 
| Sebastian |          48 |         51.1923 |  -3.1923 | 
| Inga      |          48 |         51.1923 |  -3.1923 | 
| Aneteliis |          49 |         51.1923 |  -2.1923 | 
| Bairon    |          49 |         51.1923 |  -2.1923 | 
| Joosep    |          49 |         51.1923 |  -2.1923 | 
| Lisandra  |          49 |         51.1923 |  -2.1923 | 
| Sander    |          50 |         51.1923 |  -1.1923 | 
| Oliver    |          50 |         51.1923 |  -1.1923 | 
| Kelly     |          50 |         51.1923 |  -1.1923 | 
| Lars      |          50 |         51.1923 |  -1.1923 | 
| Heike     |          50 |         51.1923 |  -1.1923 | 
| Ralf      |          50 |         51.1923 |  -1.1923 | 
| Emil      |          50 |         51.1923 |  -1.1923 | 
| Karola    |          50 |         51.1923 |  -1.1923 | 
| Konrad    |          50 |         51.1923 |  -1.1923 | 
| Otto      |          50 |         51.1923 |  -1.1923 | 
| Marek     |          51 |         51.1923 |  -0.1923 | 
| Marelle   |          51 |         51.1923 |  -0.1923 | 
| Karina    |          51 |         51.1923 |  -0.1923 | 
| Maria     |          51 |         51.1923 |  -0.1923 | 
| Marinel   |          51 |         51.1923 |  -0.1923 | 
| Gregori   |          51 |         51.1923 |  -0.1923 | 
| Marten    |          51 |         51.1923 |  -0.1923 | 
| Lysandra  |          51 |         51.1923 |  -0.1923 | 
| Sten      |          51 |         51.1923 |  -0.1923 | 
| Jaan      |          51 |         51.1923 |  -0.1923 | 
| Melani    |          51 |         51.1923 |  -0.1923 | 
| Karolin   |          51 |         51.1923 |  -0.1923 | 
| Heleriin  |          51 |         51.1923 |  -0.1923 | 
| Steven    |          52 |         51.1923 |   0.8077 | 
| Rihard    |          52 |         51.1923 |   0.8077 | 
| Kelli     |          52 |         51.1923 |   0.8077 | 
| Sebastian |          52 |         51.1923 |   0.8077 | 
| Merike    |          52 |         51.1923 |   0.8077 | 
| Rita      |          52 |         51.1923 |   0.8077 | 
| Ralf      |          52 |         51.1923 |   0.8077 | 
| Rasmus    |          52 |         51.1923 |   0.8077 | 
| Merike    |          53 |         51.1923 |   1.8077 | 
| Meribel   |          53 |         51.1923 |   1.8077 | 
| Kaidro    |          53 |         51.1923 |   1.8077 | 
| Andres    |          53 |         51.1923 |   1.8077 | 
| Prank     |          53 |         51.1923 |   1.8077 | 
| Jessika   |          53 |         51.1923 |   1.8077 | 
| Mirell    |          54 |         51.1923 |   2.8077 | 
| Lady GAGA |          90 |         51.1923 |  38.8077 | 
+-----------+-------------+-----------------+----------+
52 rows in set (0.02 sec)

2. Arvuta kui vanad on lapsed hetkel. Väljasta Eesnimi ja vanus.

mysql> select L_nimi, datediff(now(), Synnikuupaev)/365.25 as vanus from SYNNID;
+-----------+--------+
| L_nimi    | vanus  |
+-----------+--------+
| Richard   | 3.6879 | 
| Ralf      | 3.6550 | 
| Karolin   | 3.6550 | 
| Liisi     | 3.6523 | 
| Kaur      | 3.6523 | 
| Rasmus    | 3.6523 | 
| Ramona    | 3.6468 | 
| Otto      | 3.6441 | 
| Konrad    | 3.6441 | 
| Karola    | 3.6441 | 
| Sten      | 3.6413 | 
| Steven    | 3.6359 | 
| Heike     | 3.6331 | 
| Aneteliis | 3.6304 | 
| Lysandra  | 3.6277 | 
| Kelly     | 3.6249 | 
| Rihard    | 3.6194 | 
| Sander    | 3.6194 | 
| Marten    | 3.6167 | 
| Bairon    | 3.6167 | 
| Inga      | 3.6167 | 
| Sebastian | 3.6167 | 
| Jaan      | 3.6140 | 
| Elis      | 3.6140 | 
| Heleriin  | 3.6140 | 
| Andres    | 3.6112 | 
| Melani    | 3.6112 | 
| Joosep    | 3.6112 | 
| Sebastian | 3.6085 | 
| Kaidro    | 3.6085 | 
| Rasmus    | 3.6085 | 
| Ralf      | 3.6030 | 
| Jessika   | 3.6030 | 
| Prank     | 3.6003 | 
| Lars      | 3.6003 | 
| Oliver    | 3.5975 | 
| Marelle   | 3.5975 | 
| Kelli     | 3.5921 | 
| Karina    | 3.5893 | 
| Maria     | 3.5893 | 
| Marinel   | 3.5893 | 
| Lisandra  | 3.5838 | 
| Gregori   | 3.5784 | 
| Mirell    | 3.5729 | 
| Meribel   | 3.5702 | 
| Merike    | 3.5702 | 
| Tanel     | 3.5702 | 
| Emil      | 3.5619 | 
| Marek     | 3.5565 | 
| Merike    | 3.5455 | 
| Rita      | 3.5428 | 
| Lady GAGA | 4.3641 | 
+-----------+--------+
52 rows in set (0.00 sec)


3. Väljastage laste nimed, sünniajad koos nädalapäevaga, millal nad sündisid.
	nt Juku Reede 17. September 2010 (päev ja kuu võivad olla inglise keeles)

mysql> select L_nimi, dayname(Synnikuupaev) from SYNNID;
+-----------+-----------------------+
| L_nimi    | dayname(Synnikuupaev) |
+-----------+-----------------------+
| Richard   | Monday                | 
| Ralf      | Saturday              | 
| Karolin   | Saturday              | 
| Liisi     | Sunday                | 
| Kaur      | Sunday                | 
| Rasmus    | Sunday                | 
| Ramona    | Tuesday               | 
| Otto      | Wednesday             | 
| Konrad    | Wednesday             | 
| Karola    | Wednesday             | 
| Sten      | Thursday              | 
| Steven    | Saturday              | 
| Heike     | Sunday                | 
| Aneteliis | Monday                | 
| Lysandra  | Tuesday               | 
| Kelly     | Wednesday             | 
| Rihard    | Friday                | 
| Sander    | Friday                | 
| Marten    | Saturday              | 
| Bairon    | Saturday              | 
| Inga      | Saturday              | 
| Sebastian | Saturday              | 
| Jaan      | Sunday                | 
| Elis      | Sunday                | 
| Heleriin  | Sunday                | 
| Andres    | Monday                | 
| Melani    | Monday                | 
| Joosep    | Monday                | 
| Sebastian | Tuesday               | 
| Kaidro    | Tuesday               | 
| Rasmus    | Tuesday               | 
| Ralf      | Thursday              | 
| Jessika   | Thursday              | 
| Prank     | Friday                | 
| Lars      | Friday                | 
| Oliver    | Saturday              | 
| Marelle   | Saturday              | 
| Kelli     | Monday                | 
| Karina    | Tuesday               | 
| Maria     | Tuesday               | 
| Marinel   | Tuesday               | 
| Lisandra  | Thursday              | 
| Gregori   | Saturday              | 
| Mirell    | Monday                | 
| Meribel   | Tuesday               | 
| Merike    | Tuesday               | 
| Tanel     | Tuesday               | 
| Emil      | Friday                | 
| Marek     | Sunday                | 
| Merike    | Thursday              | 
| Rita      | Friday                | 
| Lady GAGA | Saturday              | 
+-----------+-----------------------+
52 rows in set (0.00 sec)


4. Väljasta laste nimed ja nädalapäevad (eesti keeles), millal nad sündisid kasuta funktsiooni if() või case().

mysql> select L_nimi, if(dayname(Synnikuupaev)=0, 'pyhapaev',if(dayname(Synnikuupaev)=1, 'esmaspaev', if(dayname(Synnikuupaev)=2, 'teisipaev', if(dayname(Synnikuupaev)=3, 'kolmapaev', if(dayname(Synnikuupaev)=4, 'neljapaev', if(dayname(Synnikuupaev)=5, 'reede', if(dayname(Synnikuupaev)=6, 'laupaev', 'puudub'))))))) as paev from SYNNID;  
+-----------+-----------+
| L_nimi    | paev      |
+-----------+-----------+
| Richard   | pyhapaev  | 
| Ralf      | reede     | 
| Karolin   | reede     | 
| Liisi     | laupaev   | 
| Kaur      | laupaev   | 
| Rasmus    | laupaev   | 
| Ramona    | esmaspaev | 
| Otto      | teisipaev | 
| Konrad    | teisipaev | 
| Karola    | teisipaev | 
| Sten      | kolmapaev | 
| Steven    | reede     | 
| Heike     | laupaev   | 
| Aneteliis | pyhapaev  | 
| Lysandra  | esmaspaev | 
| Kelly     | teisipaev | 
| Rihard    | neljapaev | 
| Sander    | neljapaev | 
| Marten    | reede     | 
| Bairon    | reede     | 
| Inga      | reede     | 
| Sebastian | reede     | 
| Jaan      | laupaev   | 
| Elis      | laupaev   | 
| Heleriin  | laupaev   | 
| Andres    | pyhapaev  | 
| Melani    | pyhapaev  | 
| Joosep    | pyhapaev  | 
| Sebastian | esmaspaev | 
| Kaidro    | esmaspaev | 
| Rasmus    | esmaspaev | 
| Ralf      | kolmapaev | 
| Jessika   | kolmapaev | 
| Prank     | neljapaev | 
| Lars      | neljapaev | 
| Oliver    | reede     | 
| Marelle   | reede     | 
| Kelli     | pyhapaev  | 
| Karina    | esmaspaev | 
| Maria     | esmaspaev | 
| Marinel   | esmaspaev | 
| Lisandra  | kolmapaev | 
| Gregori   | reede     | 
| Mirell    | pyhapaev  | 
| Meribel   | esmaspaev | 
| Merike    | esmaspaev | 
| Tanel     | esmaspaev | 
| Emil      | neljapaev | 
| Marek     | laupaev   | 
| Merike    | kolmapaev | 
| Rita      | neljapaev | 
| Lady GAGA | reede     | 
+-----------+-----------+
52 rows in set (0.00 sec)


5. Väljasta iga nädalapäeva kohta mitu last sel päeval on sündinud.

mysql> select dayname(Synnikuupaev) as paev, count(dayname(Synnikuupaev)) as mitu from SYNNID group by paev;
+-----------+------+
| paev      | mitu |
+-----------+------+
| Friday    |    6 | 
| Monday    |    7 | 
| Saturday  |   11 | 
| Sunday    |    8 | 
| Thursday  |    5 | 
| Tuesday   |   11 | 
| Wednesday |    4 | 
+-----------+------+
7 rows in set (0.00 sec)


6. Väljasta laste sünnikaalud järgmisel kujul 
   nt Juku 3kg 410grammi. 

mysql> select concat_ws('', L_nimi, ' ' ,(select left(Synnikaal, 1) as kilo from SYNNID where L_Nimi = s.L_nimi and Synnikaal = s.Synnikaal), 'kg ', (select right(Synnikaal, 3) from SYNNID where L_nimi = s.L_nimi and Synnikaal = s.Synnikaal), 'grammi' ) as a from SYNNID s;
+-------------------------+
| a                       |
+-------------------------+
| Richard 2kg 385grammi   | 
| Ralf 3kg 736grammi      | 
| Karolin 3kg 538grammi   | 
| Liisi 2kg 920grammi     | 
| Kaur 2kg 610grammi      | 
| Rasmus 2kg 462grammi    | 
| Ramona 2kg 473grammi    | 
| Otto 3kg 148grammi      | 
| Konrad 2kg 652grammi    | 
| Karola 3kg 545grammi    | 
| Sten 3kg 740grammi      | 
| Steven 3kg 850grammi    | 
| Heike 3kg 450grammi     | 
| Aneteliis 3kg 290grammi | 
| Lysandra 4kg 040grammi  | 
| Kelly 3kg 250grammi     | 
| Rihard 4kg 140grammi    | 
| Sander 3kg 330grammi    | 
| Marten 3kg 756grammi    | 
| Bairon 2kg 710grammi    | 
| Inga 3kg 056grammi      | 
| Sebastian 2kg 818grammi | 
| Jaan 3kg 496grammi      | 
| Elis 2kg 760grammi      | 
| Heleriin 3kg 398grammi  | 
| Andres 4kg 345grammi    | 
| Melani 3kg 150grammi    | 
| Joosep 3kg 460grammi    | 
| Sebastian 3kg 876grammi | 
| Kaidro 3kg 670grammi    | 
| Rasmus 3kg 670grammi    | 
| Ralf 4kg 842grammi      | 
| Jessika 3kg 670grammi   | 
| Prank 3kg 166grammi     | 
| Lars 3kg 090grammi      | 
| Oliver 3kg 640grammi    | 
| Marelle 4kg 100grammi   | 
| Kelli 3kg 540grammi     | 
| Karina 3kg 400grammi    | 
| Maria 3kg 986grammi     | 
| Marinel 4kg 062grammi   | 
| Lisandra 3kg 186grammi  | 
| Gregori 3kg 910grammi   | 
| Mirell 4kg 080grammi    | 
| Meribel 4kg 040grammi   | 
| Merike 3kg 912grammi    | 
| Tanel 3kg 104grammi     | 
| Emil 3kg 410grammi      | 
| Marek 4kg 600grammi     | 
| Merike 3kg 800grammi    | 
| Rita 3kg 778grammi      | 
| Lady GAGA 7kg 810grammi | 
+-------------------------+
52 rows in set (0.01 sec)

